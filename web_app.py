import streamlit as st
import requests
import json

st.set_page_config(page_title="–ï–ì–≠-GPT", page_icon="ü§ñ")
st.title("–ï–ì–≠-GPT –ø–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–µ 2026 ‚Äî —Ç–µ–ø–µ—Ä—å —Ç–æ—á–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç!")
st.markdown("–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π APIFreeLLM (–±–µ–∑ –∫–ª—é—á–µ–π, –±–µ–∑ –ª–∏–º–∏—Ç–æ–≤). –í—ã–±–µ—Ä–∏ –Ω–æ–º–µ—Ä –∏ –∂–º–∏!")

num = st.selectbox("–ù–æ–º–µ—Ä –∑–∞–¥–∞—á–∏:", ["6", "8", "12", "15", "16", "19-21", "23", "24", "25", "27"])

def generate_text(prompt):
    url = "https://api.apifreellm.com/v1/chat/completions"
    payload = {
        "model": "gpt-3.5-turbo",  # –ë–µ—Å–ø–ª–∞—Ç–Ω–∞—è –º–æ–¥–µ–ª—å, —Ä–∞–±–æ—Ç–∞–µ—Ç –±—ã—Å—Ç—Ä–æ
        "messages": [{"role": "user", "content": prompt}],
        "max_tokens": 1500,
        "temperature": 0.7
    }
    try:
        response = requests.post(url, json=payload, timeout=30)
        response.raise_for_status()
        data = response.json()
        return data["choices"][0]["message"]["content"]
    except Exception as e:
        return f"–û—à–∏–±–∫–∞: {str(e)}. –û–±–Ω–æ–≤–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—É –∏ –ø–æ–ø—Ä–æ–±—É–π —Å–Ω–æ–≤–∞."

if st.button("–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∑–∞–¥–∞—á—É"):
    with st.spinner("–ì–µ–Ω–µ—Ä–∏—Ä—É—é... (5‚Äì10 —Å–µ–∫)"):
        prompt = f"""–¢—ã —ç–∫—Å–ø–µ—Ä—Ç –§–ò–ü–ò –ø–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–µ 2026 –≥–æ–¥–∞. –°–≥–µ–Ω–µ—Ä–∏—Ä—É–π –Ω–æ–≤—É—é –∑–∞–¥–∞—á—É ‚Ññ{num} –¥–ª—è –ï–ì–≠ (–Ω–µ –∏–∑ –±–∞–Ω–∫–∞ –§–ò–ü–ò).
        
        –§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞:
        1. –ü–æ–ª–Ω–æ–µ —É—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏
        2. –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç (—á–∏—Å–ª–æ –∏–ª–∏ –∫–æ–¥)
        3. –ü–æ–¥—Ä–æ–±–Ω—ã–π —Ä–∞–∑–±–æ—Ä —Ä–µ—à–µ–Ω–∏—è —à–∞–≥ –∑–∞ —à–∞–≥–æ–º
        
        –°–¥–µ–ª–∞–π —Å—Ä–µ–¥–Ω–µ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏, —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ–π."""
        result = generate_text(prompt)
        st.success("–ì–æ—Ç–æ–≤–æ! –í–æ—Ç –∑–∞–¥–∞—á–∞:")
        st.markdown(result)

st.markdown("---")
st.subheader("–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ—à–µ–Ω–∏–µ")
solution = st.text_area("–í—Å—Ç–∞–≤—å —Å–≤–æ—ë —Ä–µ—à–µ–Ω–∏–µ:", height=100)
if st.button("–ü—Ä–æ–≤–µ—Ä–∏—Ç—å"):
    if solution.strip():
        with st.spinner("–ü—Ä–æ–≤–µ—Ä—è—é..."):
            check_prompt = f"""–ü—Ä–æ–≤–µ—Ä—å —Ä–µ—à–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ ‚Ññ{num} –ï–ì–≠ –ø–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–µ:
            
            –†–µ—à–µ–Ω–∏–µ: {solution}
            
            –û—Ç–≤–µ—Ç—å:
            - –û—à–∏–±–∫–∏ (–¥–∞/–Ω–µ—Ç + –æ–±—ä—è—Å–Ω–∏)
            - –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥
            - –ë–∞–ª–ª—ã –æ—Ç –§–ò–ü–ò (–∏–∑ 100)"""
            answer = generate_text(check_prompt)
            st.markdown(f"**–ü—Ä–æ–≤–µ—Ä–∫–∞:**\n{answer}")
    else:
        st.warning("–í–≤–µ–¥–∏ —Ä–µ—à–µ–Ω–∏–µ!")

st.caption("–ò—Å—Ç–æ—á–Ω–∏–∫: ApiFreeLLM.com ‚Äî –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π GPT-like API 2025. –ï—Å–ª–∏ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç, –ø–∏—à–∏ –º–Ω–µ —Å–∫—Ä–∏–Ω.")
